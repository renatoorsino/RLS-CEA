(* ::Package:: *)

(*************************************************************************)
(*                             Trapezoidal.m                             *)
(*************************************************************************)
(*                                                                       *)
(* Author: Renato Maia Matarazzo Orsino                                  *)
(* 2020-04-14                                                            *)
(*                                                                       *)
(*************************************************************************)



Trapezoidal[f_, t_, y_, h_, tol_: 1.*10^-8, maxrec_: 5]:= 
	Module[{y1, y2, n=1},
		y1 = y;
		y2 = y + h f[t, y];
		While[
			And[Norm[y1-y2] > tol, n < maxrec],
			y1 = y2;
			y2 = y + 0.5 h (f[t, y] + f[t + h, y1]);
			n++
			];
		y2
		]