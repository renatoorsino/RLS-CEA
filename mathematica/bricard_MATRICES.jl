M[1,1] = ((3 + k)*m)/6.
M[1,3] = -0.08333333333333333*((-3 + k)*m)
M[2,2] = ((3 + k)*m)/6.
M[2,5] = -0.08333333333333333*((-3 + k)*m)
M[3,1] = -0.08333333333333333*((-3 + k)*m)
M[3,3] = ((3 + k)*m)/6.
M[3,6] = -0.08333333333333333*((-3 + k)*m)
M[4,4] = ((3 + k)*m)/6.
M[4,7] = -0.08333333333333333*((-3 + k)*m)
M[5,2] = -0.08333333333333333*((-3 + k)*m)
M[5,5] = ((3 + k)*m)/6.
M[5,8] = -0.08333333333333333*((-3 + k)*m)
M[6,3] = -0.08333333333333333*((-3 + k)*m)
M[6,6] = ((3 + k)*m)/6.
M[7,4] = -0.08333333333333333*((-3 + k)*m)
M[7,7] = ((3 + k)*m)/6.
M[7,9] = -0.08333333333333333*((-3 + k)*m)
M[8,5] = -0.08333333333333333*((-3 + k)*m)
M[8,8] = ((3 + k)*m)/6.
M[8,10] = -0.08333333333333333*((-3 + k)*m)
M[9,7] = -0.08333333333333333*((-3 + k)*m)
M[9,9] = ((3 + k)*m)/6.
M[10,8] = -0.08333333333333333*((-3 + k)*m)
M[10,10] = ((3 + k)*m)/6.

f[4] = -(g*m)
f[7] = -(g*m)
f[9] = -(g*m)

A[1,1] = y[1]
A[1,2] = y[2]
A[2,1] = y[1] - y[3]
A[2,2] = (-l + y[2] - y[5])/2. + (l + y[2] - y[5])/2.
A[2,3] = -y[1] + y[3]
A[2,4] = y[4]
A[2,5] = (-l - y[2] + y[5])/2. + (l - y[2] + y[5])/2.
A[3,3] = y[3] - y[6]
A[3,4] = y[4] - y[7]
A[3,5] = (-l + y[5] - y[8])/2. + (l + y[5] - y[8])/2.
A[3,6] = -y[3] + y[6]
A[3,7] = -y[4] + y[7]
A[3,8] = (-l - y[5] + y[8])/2. + (l - y[5] + y[8])/2.
A[4,6] = y[6]
A[4,7] = y[7] - y[9]
A[4,8] = (-l + y[8] - y[10])/2. + (l + y[8] - y[10])/2.
A[4,9] = -y[7] + y[9]
A[4,10] = (-l - y[8] + y[10])/2. + (l - y[8] + y[10])/2.
A[5,9] = y[9]
A[5,10] = y[10]/2. + (-2*l + y[10])/2.
A[6,1] = y[5]/2.
A[6,2] = -0.5*y[3]
A[6,3] = -0.5*y[2]
A[6,5] = y[1]/2.
A[7,7] = (-l + y[10])/2.
A[7,8] = -0.5*y[9]
A[7,9] = (l - y[8])/2.
A[7,10] = y[7]/2.
A[8,1] = y[1]*(-y[4] + y[7]) + (y[4]*y[6] - y[3]*y[7])/2.
A[8,2] = -0.5*(y[2]*y[4]) + (y[2]*y[7])/2. + ((y[2] - y[5])*y[7] + y[4]*(-y[2] + y[8]))/2.
A[8,3] = -0.5*(y[1]*y[7])
A[8,4] = -0.5*(y[1]*y[1]) + (y[1]*y[6])/2. + (y[2]*(-y[2] + y[8]))/2.
A[8,5] = -0.5*(y[2]*y[7])
A[8,6] = (y[1]*y[4])/2.
A[8,7] = (y[1]*y[1])/2. - (y[1]*y[3])/2. + (y[2]*(y[2] - y[5]))/2.
A[8,8] = (y[2]*y[4])/2.
A[9,3] = ((y[7] - y[9])*y[9] + (l - y[10])*(-y[8] + y[10]))/2.
A[9,4] = -0.5*(y[6]*y[9])
A[9,5] = (y[6]*(l - y[10]))/2.
A[9,6] = (-(y[4]*y[9]) + y[9]*y[9] + (l - y[10])*(y[5] - y[10]))/2.
A[9,7] = (y[3]*y[9])/2.
A[9,8] = -0.5*(y[3]*(l - y[10]))
A[9,9] = -0.5*(y[4]*y[6]) + (y[3]*(y[7] - y[9]))/2. - (y[3]*y[9])/2. + y[6]*y[9]
A[9,10] = (y[3]*(l - y[10]))/2. - (y[6]*(l - y[10]))/2. - (y[6]*(y[5] - y[10]))/2. - (y[3]*(-y[8] + y[10]))/2.
A[10,1] = y[1]*y[6]*y[9] + (-(y[3]*y[6]*y[9]) - y[4]*((y[7] - y[9])*y[9] + (l - y[10])*(-y[8] + y[10])))/2.
A[10,2] = (y[2]*y[6]*y[9])/2. + (y[6]*((y[2] - y[5])*y[9] + y[4]*(-l + y[10])))/2.
A[10,3] = -0.5*(y[1]*y[6]*y[9])
A[10,4] = (y[2]*y[6]*(-l + y[10]))/2. - (y[1]*((y[7] - y[9])*y[9] + (l - y[10])*(-y[8] + y[10])))/2.
A[10,5] = -0.5*(y[2]*y[6]*y[9])
A[10,6] = (y[1]*y[1]*y[9])/2. - (y[1]*y[3]*y[9])/2. + (y[2]*((y[2] - y[5])*y[9] + y[4]*(-l + y[10])))/2.
A[10,7] = -0.5*(y[1]*y[4]*y[9])
A[10,8] = (y[1]*y[4]*(l - y[10]))/2.
A[10,9] = (y[1]*y[1]*y[6])/2. - (y[1]*y[3]*y[6])/2. + (y[2]*(y[2] - y[5])*y[6])/2. - (y[1]*y[4]*(y[7] - y[9]))/2. + (y[1]*y[4]*y[9])/2.
A[10,10] = (y[2]*y[4]*y[6])/2. - (y[1]*y[4]*(l - y[10]))/2. + (y[1]*y[4]*(-y[8] + y[10]))/2.

b[1] = -(y[11]*y[11]) - y[12]*y[12]
b[2] = -((y[11] - y[13])*(y[11] - y[13])) - y[14]*y[14] - (y[12] - y[15])*(y[12] - y[15])
b[3] = -((y[13] - y[16])*(y[13] - y[16])) - (y[14] - y[17])*(y[14] - y[17]) - (y[15] - y[18])*(y[15] - y[18])
b[4] = -(y[16]*y[16]) - (y[17] - y[19])*(y[17] - y[19]) - (y[18] - y[20])*(y[18] - y[20])
b[5] = -(y[19]*y[19]) - y[20]*y[20]
b[6] = y[12]*y[13] - y[11]*y[15]
b[7] = y[18]*y[19] - y[17]*y[20]
b[8] = -((-y[4] + y[7])*(y[11]*y[11])) - y[1]*y[14]*y[16] + y[1]*y[13]*y[17] - y[2]*(y[12] - y[15])*y[17] - 2*y[1]*y[11]*(-y[14] + y[17]) - y[11]*(-(y[7]*y[13]) + y[6]*y[14] + y[4]*y[16] - y[3]*y[17]) - y[2]*y[14]*(-y[12] + y[18]) - y[12]*((-y[2] + y[8])*y[14] + y[7]*(y[12] - y[15]) + (y[2] - y[5])*y[17] + y[4]*(-y[12] + y[18]))
b[9] = y[6]*y[14]*y[19] - y[3]*(y[17] - y[19])*y[19] - y[6]*(y[19]*y[19]) - y[3]*(y[18] - y[20])*y[20] - y[6]*y[20]*(-y[15] + y[20]) - y[16]*((l - y[10])*y[15] - y[9]*(y[14] - 2*y[19]) - y[4]*y[19] - (l + y[5] - 2*y[10])*y[20]) - y[13]*((-l + y[10])*y[18] + y[9]*(y[17] - 2*y[19]) + y[7]*y[19] + (l + y[8] - 2*y[10])*y[20])
b[10] = -(y[6]*y[9]*(y[11]*y[11])) - 2*y[1]*y[9]*y[11]*y[16] - ((y[2] - y[5])*y[9] + y[4]*(-l + y[10]))*y[12]*y[16] + y[1]*y[9]*y[13]*y[16] - 2*y[1]*y[6]*y[11]*y[19] + y[1]*y[6]*y[13]*y[19] - y[2]*y[6]*(y[12] - y[15])*y[19] - y[1]*y[1]*y[16]*y[19] + y[1]*y[3]*y[16]*y[19] - y[1]*y[4]*y[19]*(-y[17] + y[19]) - y[2]*y[6]*y[14]*y[20] - y[1]*y[4]*y[20]*(-y[18] + y[20]) - y[6]*y[12]*((-l + y[10])*y[14] + y[9]*(y[12] - y[15]) + (y[2] - y[5])*y[19] + y[4]*y[20]) - y[2]*y[16]*((-l + y[10])*y[14] + y[9]*(y[12] - y[15]) + (y[2] - y[5])*y[19] + y[4]*y[20]) + y[1]*y[14]*((-l + y[10])*y[18] + y[9]*(y[17] - 2*y[19]) + y[7]*y[19] + (l + y[8] - 2*y[10])*y[20]) + y[11]*(y[6]*y[9]*y[13] + ((y[7] - y[9])*y[9] + (l - y[10])*(-y[8] + y[10]))*y[14] + y[3]*y[9]*y[16] + y[3]*y[6]*y[19] + y[4]*((-l + y[10])*y[18] + y[9]*(y[17] - 2*y[19]) + y[7]*y[19] + (l + y[8] - 2*y[10])*y[20]))

h0[1] = (-(l*l) + y[1]*y[1] + y[2]*y[2])/2.
h0[2] = ((y[1] - y[3])*(y[1] - y[3]) + y[4]*y[4] - (l + y[2] - y[5])*(l - y[2] + y[5]))/2.
h0[3] = ((y[3] - y[6])*(y[3] - y[6]) + (y[4] - y[7])*(y[4] - y[7]) - (l + y[5] - y[8])*(l - y[5] + y[8]))/2.
h0[4] = (y[6]*y[6] + (y[7] - y[9])*(y[7] - y[9]) - (l + y[8] - y[10])*(l - y[8] + y[10]))/2.
h0[5] = (y[9]*y[9] + y[10]*(-2*l + y[10]))/2.
h0[6] = (-(y[2]*y[3]) + y[1]*y[5])/2.
h0[7] = ((l - y[8])*y[9] + y[7]*(-l + y[10]))/2.
h0[8] = (y[1]*y[1]*(-y[4] + y[7]) + y[1]*(y[4]*y[6] - y[3]*y[7]) + y[2]*((y[2] - y[5])*y[7] + y[4]*(-y[2] + y[8])))/2.
h0[9] = (y[6]*(-(y[4]*y[9]) + y[9]*y[9] + (l - y[10])*(y[5] - y[10])) + y[3]*((y[7] - y[9])*y[9] + (l - y[10])*(-y[8] + y[10])))/2.
h0[10] = (y[1]*y[1]*y[6]*y[9] + y[2]*y[6]*((y[2] - y[5])*y[9] + y[4]*(-l + y[10])) - y[1]*(y[3]*y[6]*y[9] + y[4]*((y[7] - y[9])*y[9] + (l - y[10])*(-y[8] + y[10]))))/2.

h1[1] = y[1]*y[11] + y[2]*y[12]
h1[2] = y[2]*y[12] - y[5]*y[12] + y[1]*(y[11] - y[13]) + y[3]*(-y[11] + y[13]) + y[4]*y[14] - y[2]*y[15] + y[5]*y[15]
h1[3] = (y[3] - y[6])*(y[13] - y[16]) + (y[4] - y[7])*(y[14] - y[17]) + ((l + y[5] - y[8])*(y[15] - y[18]))/2. - ((l - y[5] + y[8])*(y[15] - y[18]))/2.
h1[4] = y[6]*y[16] - y[9]*y[17] + y[8]*y[18] - y[10]*y[18] + y[7]*(y[17] - y[19]) + y[9]*y[19] - y[8]*y[20] + y[10]*y[20]
h1[5] = y[9]*y[19] + (-l + y[10])*y[20]
h1[6] = (y[5]*y[11] - y[3]*y[12] - y[2]*y[13] + y[1]*y[15])/2.
h1[7] = ((-l + y[10])*y[17] - y[9]*y[18] + (l - y[8])*y[19] + y[7]*y[20])/2.
h1[8] = (2*y[1]*(-y[4] + y[7])*y[11] + (y[4]*y[6] - y[3]*y[7])*y[11] + ((y[2] - y[5])*y[7] + y[4]*(-y[2] + y[8]))*y[12] + y[1]*y[1]*(-y[14] + y[17]) + y[1]*(-(y[7]*y[13]) + y[6]*y[14] + y[4]*y[16] - y[3]*y[17]) + y[2]*((-y[2] + y[8])*y[14] + y[7]*(y[12] - y[15]) + (y[2] - y[5])*y[17] + y[4]*(-y[12] + y[18])))/2.
h1[9] = (((y[7] - y[9])*y[9] + (l - y[10])*(-y[8] + y[10]))*y[13] + (-(y[4]*y[9]) + y[9]*y[9] + (l - y[10])*(y[5] - y[10]))*y[16] + y[6]*(-(y[9]*y[14]) - y[4]*y[19] + 2*y[9]*y[19] + (l - y[10])*(y[15] - y[20]) - (y[5] - y[10])*y[20]) + y[3]*(-(l*y[18]) + y[10]*y[18] + y[9]*(y[17] - 2*y[19]) + y[7]*y[19] + l*y[20] + y[8]*y[20] - 2*y[10]*y[20]))/2.
h1[10] = (2*y[1]*y[6]*y[9]*y[11] - (y[3]*y[6]*y[9] + y[4]*((y[7] - y[9])*y[9] + (l - y[10])*(-y[8] + y[10])))*y[11] + y[6]*((y[2] - y[5])*y[9] + y[4]*(-l + y[10]))*y[12] + y[1]*y[1]*y[9]*y[16] + y[2]*((y[2] - y[5])*y[9] + y[4]*(-l + y[10]))*y[16] + y[1]*y[1]*y[6]*y[19] + y[2]*y[6]*((-l + y[10])*y[14] + y[9]*(y[12] - y[15]) + (y[2] - y[5])*y[19] + y[4]*y[20]) - y[1]*(y[6]*y[9]*y[13] + ((y[7] - y[9])*y[9] + (l - y[10])*(-y[8] + y[10]))*y[14] + y[3]*y[9]*y[16] + y[3]*y[6]*y[19] + y[4]*(-(l*y[18]) + y[10]*y[18] + y[9]*(y[17] - 2*y[19]) + y[7]*y[19] + l*y[20] + y[8]*y[20] - 2*y[10]*y[20])))/2.

ME(y) = (2*mg*(y[4] + y[7] + y[9]) + md*(y[11]*y[11]) + md*(y[12]*y[12]) + 2*mo*y[11]*y[13] + md*(y[13]*y[13]) + md*(y[14]*y[14]) + 2*mo*y[12]*y[15] + md*(y[15]*y[15]) + 2*mo*y[13]*y[16] + md*(y[16]*y[16]) + 2*mo*y[14]*y[17] + md*(y[17]*y[17]) + 2*mo*y[15]*y[18] + md*(y[18]*y[18]) + 2*mo*y[17]*y[19] + md*(y[19]*y[19]) + 2*mo*y[18]*y[20] + md*(y[20]*y[20]))/2.
